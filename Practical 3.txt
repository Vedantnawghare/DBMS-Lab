#Joins
# to find avg salary of instructors in the CS depart.
1) find the instrutors of compt sci:-
=> select * from INSTRUCTOR where dept_id = (select dept_id from DEPARTMENT where name = 'Computer Science');

2) to calculate avg salary of the instructors
  => select avg(salary) as avg_salary from instructor where dept_id = (select dept_id from DEPARTMENT where name = 'Computer Science');

3) using joins
=> select avg(i.salary) as avg_salary from instructor I join department D on i.dept_id = d.dept_id where d.name='Computer Science';


# to find the average salary in each department:-
=> select d.name, avg(i.salary) as avg_salary from department d join instructor i on d.dept_id = i.dept_id group by d.name;
=> select d.name as d_name, avg(i.salary) from department D join instructor I on d.dept_id=i.dept_id group by d.name;

# what is the total salary of all the teachers earning more than 30k?
=>select sum(salary) as total_salary from instructor where salary > 30000;

# list the number of students enrolled in each course?
1) do this
=> CREATE TABLE STUDENT (
    student_id NUMBER(38) PRIMARY KEY,
    name       VARCHAR2(50) NOT NULL,
    tot_cred   NUMBER(3)
);

INSERT INTO STUDENT VALUES (101, 'Arjun', 20);
INSERT INTO STUDENT VALUES (102, 'Meera', 22);
INSERT INTO STUDENT VALUES (106, 'Rahul', 18);
INSERT INTO STUDENT VALUES (107, 'Sneha', 19);
INSERT INTO STUDENT VALUES (108, 'Kiran', 21);

CREATE TABLE ENROLLMENT (
    enrollment_id INT PRIMARY KEY,
    student_id INT NOT NULL,
    section_id INT NOT NULL,
    enrollment_date DATE,
    status VARCHAR(20) DEFAULT 'ENROLLED',
    FOREIGN KEY (student_id) REFERENCES STUDENT(student_id),
    FOREIGN KEY (section_id) REFERENCES SECTION(section_id)
);

INSERT INTO ENROLLMENT VALUES (1, 101, 1, DATE '2024-07-01', 'ENROLLED');
INSERT INTO ENROLLMENT VALUES (2, 102, 1, DATE '2024-07-01', 'ENROLLED');
INSERT INTO ENROLLMENT VALUES (3, 101, 2, DATE '2024-07-02', 'ENROLLED');
INSERT INTO ENROLLMENT VALUES (4, 102, 2, DATE '2024-07-02', 'ENROLLED');
INSERT INTO ENROLLMENT VALUES (5, 106, 3, DATE '2024-07-03', 'ENROLLED');
INSERT INTO ENROLLMENT VALUES (6, 107, 4, DATE '2024-07-03', 'ENROLLED');
INSERT INTO ENROLLMENT VALUES (7, 108, 5, DATE '2024-07-04', 'ENROLLED');
INSERT INTO ENROLLMENT VALUES (8, 101, 6, DATE '2024-07-04', 'ENROLLED');
INSERT INTO ENROLLMENT VALUES (9, 102, 7, DATE '2024-07-05', 'ENROLLED');
INSERT INTO ENROLLMENT VALUES (10,106, 8, DATE '2024-07-05', 'ENROLLED');

2) now
=> SELECt C.course_id, C.title, COUNT(E.student_id) AS enrolled_students FROM COURSE C LEFT JOIN SECTION S ON C.course_id = S.course_id LEFT JOIN ENROLLMENT E ON S.section_id = E.section_id GROUP BY C.course_id, C.title ORDER BY C.course_id;



#
